---
title: "Plots_Plotly"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

```{r setup, include=FALSE}

source("Skripte/import.R")
source("Skripte/subsets_erstellen.R")
source("Skripte/all_tpt.R")
source("Skripte/util.R")

knitr::opts_chunk$set(echo = TRUE)
```

## Aufteilung der richtigen Antwort nach Geschecht

```{r pressure, echo=FALSE}
fig <- plot_ly(data=data_ishiharaclean, x = ~Geschlecht, y = ~Richtig)
fig
```
## Aufteilung der falschen Antwort nach Geschecht

```{r pressure, echo=FALSE}
fig <- plot_ly(data=data_ishiharaclean, x = ~Geschlecht, y = ~Falsch)
fig
```
### Alter der Probanden
```{r pressure, echo=FALSE}
library(plotly)
labels = c('unter 11','11-20','21-30','31-40','41-50','51-60','über 60')
values = c(1,12, 67, 12, 9, 15, 4)
fig <- plot_ly(type='pie', labels=labels, values=values, 
               textinfo='percent',
               insidetextorientation='radial')
fig <- fig %>% layout(title = "Alter")
fig
```
### Smartphone Betriebssystem
```{r pressure, echo=FALSE}
library(plotly)
labels = c('IOS','Android')
values = c(48, 72)
fig <- plot_ly(type='pie', labels=labels, values=values, 
               textinfo='percent',
               insidetextorientation='radial')
fig <- fig %>% layout(title = "OS")
fig
```
### Durschnittliche Geschwindigkeit Frauen/Männer
```{r pressure, echo=FALSE}
#values  <- c(1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,77,78,79,80,81,82,83,84,85,86,87,88,89,90,91,92,93,94,95,96,97,98,99,100)

fig <- plot_ly(data=data_ishiharaclean, y = ~mean_tptr_f, type = 'bar', name = 'Frauen')
fig <- fig %>% add_trace(y = ~mean_tptr_m, name = 'Männer')
#fig <- add_trace(fig, 
#     x = values,
#     y = fitted(lm(x ~ mean_tptr_m, data_ishiharaclean)),
#     mode = "lines"
#     )
fig <- fig %>% layout(
title = "Männer vs.Frauen",
xaxis = list(title = "Aufgaben"),
yaxis = list(title = 'Durchschnitt'), 
barmode = 'group')

fig
```
### Smartphone Nutzung
```{r pressure, echo=FALSE}
library(plotly)
labels = c('sehr sicher','sicher','mittelmäßig')
values = c(69, 37,14)
fig <- plot_ly(type='pie', labels=labels, values=values, 
               textinfo='percent',
               insidetextorientation='radial')
fig <- fig %>% layout(title = "Nutzung")
fig
```
### Verteilung Männer vs. Frauen
```{r pressure, echo=FALSE}
library(plotly)
labels = c('Männer','Frauen')
values = c(65, 55)
fig <- plot_ly(type='pie', labels=labels, values=values, 
               textinfo='percent',
               insidetextorientation='radial')
fig <- fig %>% layout(title = "Verteilung Geschlecht")
fig
```
### Regressionsgerade
```{r pressure, echo=FALSE}
model<-lm(mean_tptr_f~ mean_tptr_m, data=data_ishiharaclean)
summary(model)
res<-residuals(model)
plot(mean_tptr_f~ mean_tptr_m,xlim=c(0,4), ylim=c(0,4))
abline(model,col="blue")
```
### Konfidenzintervall 95%
```{r pressure, echo=FALSE}
confint(model)
```
### Konfidenzintervall 90%
```{r pressure, echo=FALSE}
##confint(model, level=0.90)
```
### Lineare Regression Frauen
```{r pressure, echo=FALSE}
plot(mean_tptr_f, type="o", main="Frauen", ylab="Aufgaben", xlab="Durchschnittliche Geschwindigkeit", col="blue", lwd=2)
```
### Lineare Regression Männer
```{r pressure, echo=FALSE}
plot(mean_tptr_m, type="o", main="Männer", ylab="Aufgaben", xlab="Durchschnittliche Geschwindigkeit", col="blue", lwd=2)
```
### Lineare Regression Männer und Frauen
```{r pressure, echo=FALSE}
##library(ggplot2)
##ggplot(data_ishiharaclean, aes(x = mean_tptr_f, y = mean_tptr_m)) + geom_point() + geom_smooth(method = "lm", se = FALSE, size = 0.5) + labs(x = "hp (PS, horsepower)", y = "mpg - Verbrauch in miles per gallon\n(Je höher, desto sparsamer)", title = "lm(mpg ~ hp, data = mtcars)")
```

## Altersverteilung 

```{r}
age<- plot_ly(data=data_ishiharaclean, y=~mean(mean_tpt_11), type ='bar',name='unter 11')
age <- age %>% add_trace(y = ~mean(mean_tpt_1120), name = '11-20')
age <- age %>% add_trace(y = ~mean(mean_tpt_2130), name = '21-30')
age <- age %>% add_trace(y = ~mean(mean_tpt_3140), name = '31-40')
age <- age %>% add_trace(y = ~mean(mean_tpt_4150), name = '41-50')
age <- age %>% add_trace(y = ~mean(mean_tpt_5160), name = '51-60')
age <- age %>% add_trace(y = ~mean(mean_tpt_60), name = 'über 60')
age <- age %>% layout(
title = "Altersverteilung",
xaxis = list(title = "Alter"),
yaxis = list(title = 'Durchschnitt'), 
barmode = 'group')
age
```


### Regressionsgerade Männer
```{r}
x <- mean_tptr_m
y <- c(1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,77,78,79,80,81,82,83,84,85,86,87,88,89,90,91,92,93,94,95,96,97,98,99,100)
relation <- lm(y~x)

plot(y,x, col="blue", main="Männer",abline(lm(x~y)))
```
### Regressionsgerade Frauen
```{r}
x <- mean_tptr_f
y <- c(1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,77,78,79,80,81,82,83,84,85,86,87,88,89,90,91,92,93,94,95,96,97,98,99,100)
relation <- lm(y~x)

plot(y,x, col="blue", main="Frauen",abline(lm(x~y)))
```
### Smartphone Häufigkeit Nutzung
```{r pressure, echo=FALSE}
library(plotly)
labels = c('mehrmals täglich','täglich','mehrmals die Woche')
values = c(104,14,2)
fig <- plot_ly(type='pie', labels=labels, values=values, 
               textinfo='percent',
               insidetextorientation='radial')
fig <- fig %>% layout(title = "Nutzung")
fig
```
### Durschnittliche Geschwindigkeit IshiharaFalse
```{r pressure, echo=FALSE}

fig <- plot_ly(data=data_ishiharafalse, y = ~mean_tptr_if, type = 'bar')

fig <- fig %>% layout(
title = "Durchschnittliche Zeit pro Aufgabe (False)",
xaxis = list(title = "Aufgaben"),
yaxis = list(title = 'Durchschnitt'), 
barmode = 'group')

fig
```
### Durschnittliche Geschwindigkeit IshiharaClean
```{r pressure, echo=FALSE}

fig <- plot_ly(data=data_ishiharaclean, y = ~mean_tptr, type = 'bar')

fig <- fig %>% layout(
title = "Durchschnittliche Zeit pro Aufgabe (Clean)",
xaxis = list(title = "Aufgaben"),
yaxis = list(title = 'Durchschnitt'), 
barmode = 'group')

fig
```
