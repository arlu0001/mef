---
title: "Plots_Plotly"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

## R Markdown

This is an R Markdown document. Markdown is a simple formatting syntax for authoring HTML, PDF, and MS Word documents. For more details on using R Markdown see <http://rmarkdown.rstudio.com>.

When you click the **Knit** button a document will be generated that includes both content as well as the output of any embedded R code chunks within the document. You can embed an R code chunk like this:

```{r cars}
summary(cars)
```

## Including Plots

You can also embed plots, for example:

```{r pressure, echo=FALSE}
plot(pressure)
```

Note that the `echo = FALSE` parameter was added to the code chunk to prevent printing of the R code that generated the plot.

## Aufteilung der richtigen Antwort nach Geschecht

```{r pressure, echo=FALSE}
fig <- plot_ly(data=data_ishiharaclean, x = ~Geschlecht, y = ~Richtig)
fig
```
## Aufteilung der falschen Antwort nach Geschecht

```{r pressure, echo=FALSE}
fig <- plot_ly(data=data_ishiharaclean, x = ~Geschlecht, y = ~Falsch)
fig
```
### Alter der Probanden
```{r pressure, echo=FALSE}
library(plotly)
labels = c('11-20','21-30','31-40','41-50','51-60','über 60')
values = c(4, 24, 5, 6, 7, 3)
fig <- plot_ly(type='pie', labels=labels, values=values, 
               textinfo='percent',
               insidetextorientation='radial')
fig <- fig %>% layout(title = "Alter")
fig
```
### Smartphone Betriebssystem
```{r pressure, echo=FALSE}
library(plotly)
labels = c('IOS','Android')
values = c(24, 25)
fig <- plot_ly(type='pie', labels=labels, values=values, 
               textinfo='percent',
               insidetextorientation='radial')
fig <- fig %>% layout(title = "OS")
fig
````
### Durschnittliche Geschwindigkeit Frauen/Männer
```{r pressure, echo=FALSE}
fig <- plot_ly(data=data_ishiharaclean, y = ~mean_tptr_f, type = 'bar', name = 'Frauen')
fig <- fig %>% add_trace(y = ~mean_tptr_m, name = 'Männer')
fig <- fig %>% layout(
title = "Männer vs.Frauen",
xaxis = list(title = "Aufgaben"),
yaxis = list(title = 'Durchschnitt'), 
barmode = 'group')
fig
````
### Smartphone Smartphone Nutzung
```{r pressure, echo=FALSE}
library(plotly)
labels = c('sehr sicher','sicher','mittelmäßig')
values = c(26, 12,7)
fig <- plot_ly(type='pie', labels=labels, values=values, 
               textinfo='percent',
               insidetextorientation='radial')
fig <- fig %>% layout(title = "Nutzung")
fig
````
### Verteilung Männer vs. Frauen
```{r pressure, echo=FALSE}
library(plotly)
labels = c('Männer','Frauen')
values = c(64, 53)
fig <- plot_ly(type='pie', labels=labels, values=values, 
               textinfo='percent',
               insidetextorientation='radial')
fig <- fig %>% layout(title = "Verteilung Geschlecht")
fig
````
### Regressionsgerade
```{r pressure, echo=FALSE}
model<-lm(mean_tptr_f ~ mean_tptr_m , data=data_ishiharaclean)
summary(model)
res<-residuals(model)
plot(mean_tptr_f ~ mean_tptr_m,xlim=c(0,4), ylim=c(0,4))
abline(model,col="blue")
````
### Konfidenzintervall 95%
```{r pressure, echo=FALSE}
confint(model)
````
### Konfidenzintervall 90%
```{r pressure, echo=FALSE}
confint(model, level=0.90)
````
### Lineare Regression Frauen
```{r pressure, echo=FALSE}
plot(mean_tptr_f, type="o", main="Frauen", ylab="Aufgaben", xlab="Durchschnittliche Geschwindigkeit", col="blue", lwd=2)
````
### Lineare Regression Männer
```{r pressure, echo=FALSE}
plot(mean_tptr_m, type="o", main="Männer", ylab="Aufgaben", xlab="Durchschnittliche Geschwindigkeit", col="blue", lwd=2)
````
### Lineare Regression Männer und Frauen
```{r pressure, echo=FALSE}
library(ggplot2)
ggplot(data_ishiharaclean, aes(x = mean_tptr_f, y = mean_tptr_m)) + geom_point() + geom_smooth(method = "lm", se = FALSE, size = 0.5) + labs(x = "hp (PS, horsepower)", y = "mpg - Verbrauch in miles per gallon\n(Je höher, desto sparsamer)", title = "lm(mpg ~ hp, data = mtcars)")
````